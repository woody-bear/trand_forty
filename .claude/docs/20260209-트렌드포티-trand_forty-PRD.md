# 트렌드포티 (Trand Forty) - PRD

> **문서 버전:** v1.0
> **작성일:** 2026-02-09
> **상태:** Draft

---

## 1. 제품 개요

### 1.1 제품명
**트렌드포티 (Trand Forty)** — 네이버 트렌드 + 구글 트렌드 기반 키워드 분석 및 워드프레스 자동 블로그 발행 시스템

### 1.2 문제 정의
- 트렌드 키워드를 수동으로 찾고 블로그 글을 작성하는 데 매일 수 시간이 소요됨
- 네이버와 구글 양쪽의 트렌드를 동시에 파악하기 어려움
- 7개 카테고리에 대해 매일 일관된 품질의 콘텐츠를 생산하는 것이 사람 노동력으로 비현실적

### 1.3 해결 방안
매일 자동으로:
1. 네이버 데이터랩 + 구글 트렌드에서 7개 카테고리별 인기 키워드를 수집
2. 양쪽 데이터를 교차 분석하여 카테고리당 최적의 키워드 1개를 선정
3. 선정된 키워드를 기반으로 SEO 최적화된 블로그 글을 AI로 생성
4. 워드프레스 블로그에 자동 발행

### 1.4 카테고리 (7개)
| ID | 카테고리 | 영문 | 네이버 검색 키워드 예시 |
|----|---------|------|----------------------|
| 1 | 정치 | politics | 대통령, 국회, 선거, 정당 |
| 2 | 경제 | economy | GDP, 금리, 환율, 물가 |
| 3 | 주식 | stock | 코스피, 삼성전자, 주가, 상장 |
| 4 | 코인 | crypto | 비트코인, 이더리움, 업비트, 김치프리미엄 |
| 5 | 문화 | culture | 영화, 드라마, 넷플릭스, 공연 |
| 6 | 스포츠 | sports | 야구, 축구, KBO, 프리미어리그 |
| 7 | 사회 | society | 사건사고, 날씨, 교육, 부동산 |

---

## 2. 핵심 기능 상세

### 2.1 키워드 수집 엔진

#### 네이버 데이터랩 연동
- **API:** `POST https://openapi.naver.com/v1/datalab/search`
- **인증:** `X-Naver-Client-Id` / `X-Naver-Client-Secret` 헤더
- **방식:** 카테고리별 시드 키워드 그룹을 등록하고, 최근 7일간 검색량 추이를 조회
- **제한:** 일 1,000회 호출, 요청당 최대 5개 키워드 그룹 (그룹당 20개 키워드)
- **참고:** 실시간 급상승 검색어는 2021년 2월 폐지됨 → 상대적 검색량(0~100) 기반으로 분석

#### 구글 트렌드 연동
- **방식:** `trendspyg` 라이브러리 활용 (pytrends는 2025년 4월 archived)
- **지역:** `geo='KR'` (대한민국)
- **데이터:** Trending Now(실시간 인기 검색어) + Interest Over Time
- **주의:** Google 봇 탐지로 인한 429 에러 대비 → 요청 간 60초 딜레이, 재시도 로직 필수
- **대안:** SerpApi Google Trends API (유료, 월 $75~, 안정적)

#### 데이터 수집 주기
- **매일 1회:** 오전 6:00 KST (크론 스케줄러)
- 네이버: 최근 7일 데이터 조회
- 구글: 최근 24시간 Trending Now + 7일 Interest Over Time

### 2.2 키워드 선정 알고리즘

```
카테고리별 처리 흐름:
1. 네이버 시드 키워드 그룹 검색량 조회 → 상위 N개 추출
2. 구글 Trending Now에서 해당 카테고리 관련 키워드 추출
3. 교차 매칭: 양쪽에서 공통으로 높은 관심도를 보이는 키워드 우선
4. 스코어링:
   - 네이버 검색량 비율 (0~100) × 0.5
   - 구글 관심도 (0~100) × 0.3
   - 뉴스/실시간성 보너스 × 0.2
5. 카테고리당 최고 점수 키워드 1개 선정
6. 중복 제거: 이전 7일간 사용된 키워드 제외
```

### 2.3 블로그 글 자동 생성

#### AI 글 생성
- **모델:** Claude API (Anthropic) 또는 OpenAI GPT-4
- **프롬프트 구성:**
  - 선정된 키워드
  - 카테고리 컨텍스트
  - 최신 뉴스 요약 (선택적: 네이버 뉴스 검색 API 연동)
  - SEO 가이드라인 (제목 패턴, 메타 디스크립션, H2/H3 구조, 키워드 밀도)
- **출력 형식:**
  - 제목 (title): SEO 최적화, 40~60자
  - 본문 (content): 1,500~2,500자, HTML 또는 마크다운
  - 요약 (excerpt): 150자 이내
  - 태그 (tags): 5~10개
  - 메타 디스크립션: 155자 이내
  - 대표 이미지 프롬프트 (선택): AI 이미지 생성용

#### 글 품질 관리
- 이전 발행 글과의 유사도 체크 (중복 방지)
- 카테고리별 톤/스타일 가이드 적용
- 금칙어/민감 키워드 필터링

### 2.4 워드프레스 자동 발행

- **API:** WordPress REST API (`/wp-json/wp/v2/posts`)
- **인증:** Application Passwords (WordPress 5.6+ 내장, 플러그인 불필요)
- **발행 흐름:**
  1. 카테고리 존재 여부 확인 → 없으면 생성 (`/wp/v2/categories`)
  2. 태그 생성/매핑 (`/wp/v2/tags`)
  3. (선택) 대표 이미지 업로드 (`/wp/v2/media`)
  4. 글 발행 (`POST /wp/v2/posts`, `status: 'publish'`)
  5. SEO 플러그인 메타 데이터 설정 (Yoast/Rank Math 지원 시)
- **발행 스케줄:**
  - 매일 7개 글 (카테고리별 1개)
  - 08:00~15:00 KST 사이 1시간 간격으로 순차 발행 (트래픽 분산)

---

## 3. 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────┐
│                    Scheduler (Cron)                       │
│                  매일 06:00 KST 실행                      │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌──────────────────────────────────────────────────────────┐
│              Keyword Collector                             │
│  ┌─────────────────┐    ┌──────────────────┐             │
│  │  Naver DataLab   │    │  Google Trends    │             │
│  │  API Client      │    │  (trendspyg)      │             │
│  └────────┬────────┘    └────────┬─────────┘             │
│           └──────────┬───────────┘                        │
│                      ▼                                    │
│           Keyword Ranker & Selector                       │
│           (카테고리별 Top 1 선정)                           │
└──────────────────────┬───────────────────────────────────┘
                       │
                       ▼
┌──────────────────────────────────────────────────────────┐
│              Content Generator                            │
│  ┌──────────────────┐  ┌──────────────────────┐          │
│  │  AI Writer        │  │  News Fetcher         │          │
│  │  (Claude/GPT API) │  │  (네이버 뉴스 검색)    │          │
│  └────────┬─────────┘  └────────┬─────────────┘          │
│           └──────────┬───────────┘                        │
│                      ▼                                    │
│           Content Validator                               │
│           (품질 검증, 중복 체크)                             │
└──────────────────────┬───────────────────────────────────┘
                       │
                       ▼
┌──────────────────────────────────────────────────────────┐
│              WordPress Publisher                           │
│  ┌──────────────────┐  ┌──────────────────────┐          │
│  │  REST API Client  │  │  Media Uploader       │          │
│  │  (posts/tags/cat) │  │  (대표 이미지)         │          │
│  └────────┬─────────┘  └────────┬─────────────┘          │
│           └──────────┬───────────┘                        │
│                      ▼                                    │
│           Publish Scheduler                               │
│           (08:00~15:00 순차 발행)                           │
└──────────────────────┬───────────────────────────────────┘
                       │
                       ▼
┌──────────────────────────────────────────────────────────┐
│              Data Store (SQLite)                           │
│  - 키워드 이력 (중복 방지)                                  │
│  - 발행 로그                                               │
│  - 에러 로그                                               │
│  - 글 메타데이터                                            │
└──────────────────────────────────────────────────────────┘
```

---

## 4. 데이터 모델

### 4.1 keywords 테이블
| 필드 | 타입 | 설명 |
|------|------|------|
| id | INTEGER PK | 자동증가 |
| keyword | TEXT | 키워드 |
| category | TEXT | 카테고리 (politics, economy, ...) |
| naver_score | REAL | 네이버 검색량 점수 (0~100) |
| google_score | REAL | 구글 관심도 점수 (0~100) |
| combined_score | REAL | 종합 점수 |
| collected_at | DATETIME | 수집 시각 |
| used | BOOLEAN | 글 생성에 사용 여부 |

### 4.2 posts 테이블
| 필드 | 타입 | 설명 |
|------|------|------|
| id | INTEGER PK | 자동증가 |
| keyword_id | INTEGER FK | 사용된 키워드 |
| title | TEXT | 글 제목 |
| content | TEXT | 글 본문 (HTML) |
| excerpt | TEXT | 요약 |
| category | TEXT | 카테고리 |
| tags | TEXT | JSON 배열 |
| wp_post_id | INTEGER | 워드프레스 게시물 ID |
| status | TEXT | draft / published / failed |
| published_at | DATETIME | 발행 시각 |
| created_at | DATETIME | 생성 시각 |

### 4.3 logs 테이블
| 필드 | 타입 | 설명 |
|------|------|------|
| id | INTEGER PK | 자동증가 |
| level | TEXT | INFO / WARN / ERROR |
| module | TEXT | collector / generator / publisher |
| message | TEXT | 로그 메시지 |
| created_at | DATETIME | 로그 시각 |

---

## 5. 외부 서비스 및 API 키 요구사항

| 서비스 | 용도 | 필요한 키 | 비용 |
|--------|------|----------|------|
| 네이버 개발자 센터 | DataLab 검색 트렌드 | Client ID + Secret | 무료 (일 1,000건) |
| 네이버 개발자 센터 | 뉴스 검색 API | 동일 키 사용 가능 | 무료 (일 25,000건) |
| Google Trends | 트렌드 데이터 수집 | 불필요 (trendspyg) | 무료 |
| Anthropic Claude API | 블로그 글 생성 | API Key | 사용량 기반 과금 |
| WordPress | 블로그 발행 | Application Password | 자체 호스팅 비용 |

### 비용 추정 (월간)
- **네이버 API:** 무료 (일 7~14회 호출, 한도 내)
- **구글 트렌드:** 무료 (trendspyg 사용)
- **AI 글 생성:** 약 $5~15/월 (7글/일 × 30일 = 210글, 글당 ~2K 토큰 입출력)
- **WordPress 호스팅:** 별도 (기존 호스팅 사용 가정)
- **예상 총비용:** 월 $5~15 (AI API 비용만)

---

## 6. 비기능 요구사항

### 6.1 안정성
- 외부 API 장애 시 재시도 로직 (최대 3회, 지수 백오프)
- 네이버 또는 구글 한쪽 실패 시 나머지 데이터로 단독 운영 가능
- 모든 단계별 에러 로깅

### 6.2 중복 방지
- 최근 7일 내 동일 키워드 재사용 금지
- 발행된 글 제목 유사도 검사

### 6.3 설정 관리
- `.env` 파일로 모든 API 키 및 설정 관리
- `config.yaml`로 카테고리별 시드 키워드, 스케줄, 발행 설정 관리

### 6.4 모니터링
- 일일 실행 결과 리포트 (성공/실패 건수)
- 에러 발생 시 알림 (선택: Slack, Email, Telegram)

---

## 7. MVP 범위 (Phase 1)

### 포함
- [x] 네이버 데이터랩 키워드 수집
- [x] 구글 트렌드 키워드 수집 (trendspyg)
- [x] 카테고리별 키워드 선정 알고리즘
- [x] Claude API 기반 블로그 글 생성
- [x] 워드프레스 REST API 자동 발행
- [x] SQLite 키워드/발행 이력 관리
- [x] 크론 스케줄러 (일 1회 실행)
- [x] CLI 인터페이스 (수동 실행)

### 미포함 (Phase 2 이후)
- [ ] 웹 대시보드 (발행 현황, 키워드 트렌드 시각화)
- [ ] 대표 이미지 AI 생성 및 자동 업로드
- [ ] 다중 블로그 지원
- [ ] A/B 테스트 (제목/본문 변형)
- [ ] 발행 글 성과 추적 (조회수, 유입 키워드)
- [ ] Slack/Telegram 알림 연동
- [ ] 시드 키워드 자동 확장

---

## 8. 성공 지표

| 지표 | 목표 |
|------|------|
| 일일 자동 발행 성공률 | 95% 이상 (7글 중 최소 6~7글) |
| 키워드 수집 성공률 | 100% (한쪽 소스 실패 시 대체) |
| 글 생성 소요 시간 | 7글 기준 10분 이내 |
| 전체 파이프라인 소요 시간 | 수집~발행 완료 30분 이내 |
