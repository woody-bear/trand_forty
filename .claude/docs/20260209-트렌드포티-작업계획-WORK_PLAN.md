# 트렌드포티 (Trand Forty) - 작업계획

> **작성일:** 2026-02-09

---

## 전체 일정 개요

| Phase | 기간 | 내용 |
|-------|------|------|
| Phase 0 | Day 1 | 프로젝트 초기화 + 환경 설정 |
| Phase 1 | Day 2~3 | 키워드 수집 엔진 |
| Phase 2 | Day 4 | 키워드 분석/선정 알고리즘 |
| Phase 3 | Day 5~6 | AI 글 생성 엔진 |
| Phase 4 | Day 7 | 워드프레스 자동 발행 |
| Phase 5 | Day 8 | 스케줄러 + 파이프라인 통합 |
| Phase 6 | Day 9~10 | 테스트 + 안정화 + 배포 |

---

## Phase 0: 프로젝트 초기화 (Day 1)

### 작업 목록
- [ ] **0-1.** Git 저장소 초기화
- [ ] **0-2.** `pyproject.toml` 작성 (uv 기반)
  - 프로젝트 메타데이터
  - 런타임 + 개발 의존성
  - ruff 설정 (line-length=120, target-version="py311")
  - pytest 설정
- [ ] **0-3.** 디렉토리 구조 생성 (`src/trand_forty/`, `tests/`, `data/`, `logs/`)
- [ ] **0-4.** `.gitignore` 작성 (`.env`, `data/`, `logs/`, `__pycache__/`, `.venv/`)
- [ ] **0-5.** `.env.example` 작성
- [ ] **0-6.** `config.yaml` 작성 (7개 카테고리 + 시드 키워드 초기값)
- [ ] **0-7.** `src/trand_forty/config.py` — 설정 로더 구현
- [ ] **0-8.** `src/trand_forty/db.py` — SQLite 스키마 초기화 (keywords, posts, logs 테이블)
- [ ] **0-9.** `uv sync` 실행, 개발환경 정상 동작 확인

### 완료 기준
- `uv run python -m trand_forty` 실행 시 에러 없이 종료
- DB 파일 생성 + 테이블 존재 확인

---

## Phase 1: 키워드 수집 엔진 (Day 2~3)

### 작업 목록
- [ ] **1-1.** `src/trand_forty/collectors/naver.py` — 네이버 DataLab API 클라이언트
  - `search_trend(keyword_groups, start_date, end_date)` 메서드
  - 인증 헤더 처리
  - 에러 핸들링 (429, 500, 네트워크 에러)
  - 재시도 로직 (지수 백오프, 최대 3회)
- [ ] **1-2.** `src/trand_forty/collectors/google.py` — Google Trends 클라이언트
  - `get_trending_now(geo='KR')` — 실시간 인기 검색어
  - `get_interest_over_time(keywords, geo='KR')` — 키워드별 관심도
  - trendspyg 래핑
  - 요청 간 딜레이 (60초) + 429 재시도
- [ ] **1-3.** 카테고리별 시드 키워드를 config.yaml에서 로드하여 수집하는 통합 함수
- [ ] **1-4.** 수집된 키워드를 DB에 저장하는 로직
- [ ] **1-5.** 단위 테스트 작성 (모킹 기반)
  - 네이버 API 응답 파싱 테스트
  - 구글 트렌드 데이터 파싱 테스트
  - 에러 케이스 (타임아웃, 429, 빈 응답)

### 완료 기준
- 실제 API 호출로 7개 카테고리 키워드 수집 성공
- DB에 수집 결과 저장 확인
- 테스트 전체 통과

---

## Phase 2: 키워드 분석/선정 알고리즘 (Day 4)

### 작업 목록
- [ ] **2-1.** `src/trand_forty/analyzer/ranker.py` — 키워드 스코어링 엔진
  - 네이버 점수 (0~100) × 0.5
  - 구글 점수 (0~100) × 0.3
  - 뉴스성/실시간성 보너스 × 0.2
  - 카테고리별 키워드 매칭 로직
- [ ] **2-2.** 중복 제거 로직 — 최근 7일 사용 키워드 DB 조회 후 필터링
- [ ] **2-3.** 카테고리당 최종 1개 키워드 선정 함수
- [ ] **2-4.** 단위 테스트
  - 스코어링 계산 정확성
  - 중복 필터링 동작
  - 한쪽 소스 데이터 누락 시 fallback

### 완료 기준
- 7개 카테고리에서 각각 1개씩 키워드 선정 (중복 없음)
- 이전 7일 데이터와 겹치지 않음 확인

---

## Phase 3: AI 글 생성 엔진 (Day 5~6)

### 작업 목록
- [ ] **3-1.** `src/trand_forty/generator/prompts.py` — 프롬프트 템플릿 정의
  - 카테고리별 톤/스타일 가이드
  - SEO 최적화 지침 (제목 패턴, H2/H3, 키워드 밀도)
  - 출력 형식 지정 (제목, 본문, 요약, 태그, 메타디스크립션)
- [ ] **3-2.** `src/trand_forty/generator/writer.py` — Claude API 기반 글 생성
  - `generate_post(keyword, category, context)` 메서드
  - 응답 파싱 (구조화된 출력 → title, content, excerpt, tags, meta)
  - 토큰 사용량 로깅
- [ ] **3-3.** (선택) 네이버 뉴스 검색 API 연동 — 키워드 관련 최신 뉴스 3~5건을 컨텍스트로 제공
- [ ] **3-4.** 글 품질 검증
  - 최소 길이 검사 (1,500자 이상)
  - HTML 유효성 검사
  - 금칙어 필터링
- [ ] **3-5.** 생성된 글을 DB에 저장
- [ ] **3-6.** 단위 테스트 (Claude API 모킹)

### 완료 기준
- 7개 키워드로 7개 블로그 글 생성 성공
- 각 글이 제목, 본문(1,500자+), 요약, 태그 포함
- DB에 저장 확인

---

## Phase 4: 워드프레스 자동 발행 (Day 7)

### 작업 목록
- [ ] **4-1.** `src/trand_forty/publisher/wordpress.py` — WP REST API 클라이언트
  - `create_or_get_category(name)` — 카테고리 생성/조회
  - `create_tags(tag_names)` — 태그 생성/조회
  - `create_post(title, content, excerpt, category_id, tag_ids, status)` — 글 발행
  - Basic Auth (Application Password) 인증 처리
- [ ] **4-2.** 발행 결과를 DB에 기록 (wp_post_id, status, published_at)
- [ ] **4-3.** 에러 핸들링 (인증 실패, 네트워크 에러, WP 서버 에러)
- [ ] **4-4.** SEO 플러그인 메타데이터 설정 (Yoast/Rank Math 있을 경우)
- [ ] **4-5.** 단위 테스트 (WP API 모킹)

### 완료 기준
- 테스트 블로그에 글 1건 자동 발행 성공
- 카테고리/태그 자동 생성 확인
- 발행 결과 DB 기록 확인

---

## Phase 5: 스케줄러 + 파이프라인 통합 (Day 8)

### 작업 목록
- [ ] **5-1.** `src/trand_forty/main.py` — 전체 파이프라인 오케스트레이션
  ```
  collect_keywords() → rank_keywords() → generate_posts() → publish_posts()
  ```
- [ ] **5-2.** CLI 인터페이스 (argparse)
  - `python -m trand_forty run` — 전체 파이프라인 실행
  - `python -m trand_forty collect` — 키워드 수집만
  - `python -m trand_forty generate` — 글 생성만 (오늘 키워드 기반)
  - `python -m trand_forty publish` — 미발행 글 발행만
  - `python -m trand_forty status` — 오늘 처리 현황 출력
- [ ] **5-3.** 발행 시간 분산 로직 (08:00~15:00 사이 1시간 간격)
- [ ] **5-4.** `src/trand_forty/scheduler/cron.py` — crontab 설정 헬퍼
  - crontab 등록/해제 명령어 생성
- [ ] **5-5.** 전체 파이프라인 end-to-end 테스트

### 완료 기준
- `python -m trand_forty run` 실행 시 수집→분석→생성→발행 전 과정 완료
- 7개 글이 1시간 간격으로 순차 발행 확인

---

## Phase 6: 테스트 + 안정화 + 배포 (Day 9~10)

### 작업 목록
- [ ] **6-1.** 통합 테스트 — 실제 API 연동 (네이버, 구글, WP)으로 전체 흐름 1회 실행
- [ ] **6-2.** 에러 시나리오 테스트
  - 네이버 API 다운 → 구글만으로 동작
  - 구글 트렌드 429 → 재시도 후 fallback
  - WP 서버 다운 → 글 draft 상태 유지, 다음 실행 시 재시도
  - Claude API 에러 → 해당 카테고리 건너뛰기
- [ ] **6-3.** 로깅 정리 — 파일 + 콘솔 출력, 로그 로테이션 설정
- [ ] **6-4.** 배포 문서 작성
  - 서버(VPS/클라우드) crontab 설정 방법
  - 환경변수 설정 가이드
  - 첫 실행 체크리스트
- [ ] **6-5.** CLAUDE.md 작성 — 프로젝트 개발 가이드

### 완료 기준
- 3일 연속 자동 실행 성공 (21글 발행)
- 에러 발생 시 적절한 로깅 + 부분 실패 복구 확인

---

## 리스크 및 대응 방안

| 리스크 | 영향 | 대응 |
|--------|------|------|
| Google Trends 봇 탐지 (429) | 구글 데이터 수집 실패 | 요청 딜레이 증가, 프록시 사용, SerpApi 전환 |
| 네이버 API 일 한도 초과 | 수집 실패 | 7개 카테고리 × 2회 = 14회/일 (한도 1,000 대비 충분) |
| trendspyg 라이브러리 중단 | 구글 수집 불가 | SerpApi 유료 전환 또는 직접 스크래핑 |
| Claude API 비용 증가 | 운영비 상승 | 프롬프트 최적화, 모델 다운그레이드 (Haiku) |
| WordPress 보안 이슈 | 블로그 해킹 | HTTPS 필수, App Password 주기적 갱신 |
| 생성 글 품질 저하 | SEO 패널티 | 프롬프트 튜닝, 품질 검증 강화 |

---

## 우선순위 원칙

1. **동작하는 최소 기능 먼저** — 처음부터 완벽한 알고리즘보다 end-to-end 파이프라인 완성 우선
2. **한쪽 실패 시 나머지로 동작** — 네이버/구글 중 하나만으로도 키워드 선정 가능하게
3. **수동 실행 먼저, 자동화 나중에** — CLI 완성 후 cron 설정
4. **로깅 철저히** — 모든 API 호출과 결과를 기록하여 디버깅 용이하게
